<?xml version="1.0" encoding="UTF-8"?>
<project
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"
	xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<modelVersion>4.0.0</modelVersion>
	<parent>
		<groupId>msi.gama</groupId>
		<artifactId>msi.gama.parent</artifactId>
		<version>1.7.0-SNAPSHOT</version>
		<relativePath>../msi.gama.parent/</relativePath>
	</parent>
	<artifactId>msi.gama.application</artifactId>
	<packaging>eclipse-repository</packaging>

	<properties>
		<product.finalName>Gama</product.finalName>
		<product.id>msi.gama.application.product</product.id>
		<product.outputDirectory>${basedir}/products</product.outputDirectory>
	</properties>
	<build>
		<plugins>
			<plugin>
				<!-- Use compiler plugin with tycho as the adapter to the JDT compiler. -->
				<groupId>org.eclipse.tycho</groupId>
				<artifactId>tycho-compiler-plugin</artifactId>
				<version>${tycho.version}</version>
				<configuration>
					<source>1.8</source>
					<target>1.8</target>
					<compilerArgument>-proc:none</compilerArgument>
					<annotationProcessors>
						<annotationProcessor>msi.gama.precompiler.GamaProcessor</annotationProcessor>
					</annotationProcessors>
				</configuration>
			</plugin>
			<!-- Workaround: Use an existing config.ini file (caused by the problem 
				that tycho will always generate a default one) -->
			<!-- <plugin> <artifactId>maven-resources-plugin</artifactId> <executions> 
				<execution> <phase>package</phase> <goals> <goal>copy-resources</goal> </goals> 
				<configuration> <resources> <resource> <directory>${project.build.directory}/../</directory> 
				<filtering>false</filtering> <includes> <include>config.ini</include> </includes> 
				</resource> </resources> <outputDirectory>${product.outputDirectory}/configuration</outputDirectory> 
				<overwrite>true</overwrite> </configuration> </execution> </executions> </plugin> -->
			<!-- Configure the assembly plugin to build the final file (war or zip) -->
			<!-- <plugin> <artifactId>maven-assembly-plugin</artifactId> <configuration> 
				<descriptors> <descriptor>assembly.xml</descriptor> </descriptors> <finalName>${product.finalName}</finalName> 
				<appendAssemblyId>false</appendAssemblyId> </configuration> <executions> 
				<execution> <id>make-assembly</id> <phase>package</phase> <goals> <goal>single</goal> 
				</goals> </execution> </executions> </plugin> -->
			<plugin>
				<groupId>org.eclipse.tycho</groupId>
				<artifactId>tycho-p2-repository-plugin</artifactId>
				<version>${tycho.version}</version>
				<configuration>
					<includeAllDependencies>true</includeAllDependencies>
				</configuration>
			</plugin>
			<plugin>
				<groupId>org.eclipse.tycho</groupId>
				<artifactId>tycho-p2-director-plugin</artifactId>
				<version>${tycho.version}</version>
				<executions>
					<execution>
						<id>create-distributions</id>
						<goals>
							<goal>materialize-products</goal>
							<goal>archive-products</goal>
						</goals>
					</execution>
				</executions>

			</plugin>

			<!-- Workaround: Use an existing config.ini file (caused by the problem 
				that tycho will always generate a default one) -->
			<plugin>
				<artifactId>maven-resources-plugin</artifactId>
				<executions>
					<execution>
						<phase>package</phase>
						<goals>
							<goal>copy-resources</goal>
						</goals>
						<configuration>
							<resources>
								<resource>
									<directory>${project.build.directory}/../</directory>
									<filtering>false</filtering>
									<!-- in case you have a defined config.ini -->
									<!-- <includes> <include>config.ini</include> </includes> -->
									<!-- <excludes> <exclude>src</exclude> <exclude>gaml</exclude> <exclude>target</exclude> 
										<exclude>META-INF</exclude> <exclude>bin</exclude> <exclude>products</exclude> 
										</excludes> -->
								</resource>
							</resources>
							<outputDirectory>${project.build.directory}/configuration</outputDirectory>
							<overwrite>true</overwrite>
						</configuration>
					</execution>
				</executions>
			</plugin>
		</plugins>
	</build>

</project>
